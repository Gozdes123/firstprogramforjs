const menu = [
    {
        id: 0,
        title: '間諜家家酒',
        category: '奇幻',
        img: 'img/anime/img0.jpg',
        btn: 'btn0',
        src: 'https://www.youtube.com/embed/l1uINfUshjc',
        content:
            '《SPY×FAMILY間諜家家酒》（日語：スパイファミリー，英語：SPY×FAMILY，中國大陸譯作「間諜過家家」）是由日本漫畫家遠藤達哉所創作的作品，在2019年3月25日起於日本《少年Jump+》上定期連載，台灣於《寶島少年EX》上連載。本作敘述一名身為間諜的男性、另一位實際工作是殺手的女性，以及一個能讀心的超能力者女孩，三人互相隱瞞真實身分所組成的虛假家庭間的家庭喜劇。《SPY×FAMILY間諜家家酒》在2020年版的《這本漫畫真厲害！》贏得男生篇第一名。截至2022年5月，累積發行量突破2100萬冊。2021年11月1日宣佈改編電視動畫，由WIT STUDIO與CloverWorks製作，2022年4月起分上下兩季首度播出。',
    },
    {
        id: 1,
        title: '輝夜姬想讓人告白',
        category: '愛情',
        img: 'img/anime/img1.jpg',
        btn: 'btn1',
        src: 'https://www.youtube.com/embed/1SNeGbYaZkw',
        content:
            '《輝夜姬想讓人告白～天才們的戀愛頭腦戰～》（日語：かぐや様は告らせたい〜天才たちの恋愛頭脳戦〜），官方簡稱《輝夜姬》（日語：かぐや様），是日本漫畫家赤坂明的校園漫畫作品，起初於日本漫畫雜誌《Miracle Jump》2015年6月號至2016年2月號連載；後移籍至《週刊YOUNG JUMP》，於2016年17號開始連載。漫畫被改編為各種系列的衍生作品，包括同名的動畫、電影、小說等周邊媒體產品。至2022年止，已發行25冊。截至2022年3月，本系列作的累計發行量已超過1750萬冊。漫畫改編電視動畫由A-1 Pictures製作，第1季於2019年1月至3月播出；第2季於2020年4月至6月播出；2021年5月19日發售第2季OVA。2020年10月25日宣布第3期動畫製作確定，於2022年4月9日播出。2017年8月，在第三屆《下一部漫畫大賞》漫畫部門以11,884張的票數獲得第一名。2020年1月，榮獲第65屆《小學館漫畫賞》一般向部門獎，為《週刊YOUNG JUMP》創刊52年來唯一獲得此獎的作品。2020年3月，榮獲2019年BOOK☆WALKER大賞第一名。作品的人物多參考自《竹取物語》，部分人物關係亦與其故事內容呼應。',
    },
    {
        id: 2,
        title: '新石記',
        category: '奇幻',
        img: 'img/anime/img2.jpg',
        btn: 'btn2',
        src: 'https://www.youtube.com/embed/oStI21bhOEA',
        content:
            '《Dr.STONE 新石紀》（日語：ドクターストーン），是日本漫畫家稻垣理一郎（原作）和Boichi（作畫）創作的一部少年科學漫畫作品，該作於2017年3月在日本集英社漫畫雜誌《週刊少年Jump》上連載，至2022年3月連載結束。2019年7月5日開始播映同名電視動畫。漫畫家Boichi在《週刊少年Jump》第48期同時連載獨自創作番外篇作品《Dr.STONE reboot：百夜》，2019年10月28日開始連載，稻垣理一郎於自己的Twitter上提到此外傳系列預計共9話。在2019年12月13日，動畫第1季結束時，宣布製作第2季。動畫第2季於2021年1月14日開播。在2021年12月19日，2022年夏預定開播動畫特別篇《Dr.STONE 新石紀 龍水。並在同時，宣布將製作動畫第3季於2023年春預定開播。',
    },
    {
        id: 3,
        title: '炎炎消防隊',
        category: '熱血',
        img: 'img/anime/img3.jpg',
        btn: 'btn3',
        src: 'https://www.youtube.com/embed/fwtm_DVGwUQ',
        content: '',
    },
    {
        id: 4,
        title: '歡迎來到實力至上主義的教室',
        category: '社會寫實',
        img: 'img/anime/img4.jpg',
        btn: 'btn4',
        src: 'https://www.youtube.com/embed/oQBdbfjHvjM',
        content: '',
    },
    {
        id: 5,
        title: '杜鵑的婚約',
        category: '幽默搞笑',
        img: 'img/anime/img5.jpg',
        btn: 'btn5',
        src: 'https://www.youtube.com/embed/nLkXDK0WjV0',
        content: '',
    },
    {
        id: 6,
        title: '盾之勇者成名錄',
        category: '奇幻',
        img: 'img/anime/img6.jpg',
        btn: 'btn6',
        src: 'https://www.youtube.com/embed/VxNNQlJkOjU',
        content: '',
    },
    {
        id: 7,
        title: '白領羽球部',
        category: '運動',
        img: 'img/anime/img7.jpg',
        btn: 'btn7',
        src: 'https://www.youtube.com/embed/cBqbxUmI3Rc',
        content: '',
    },
    {
        id: 8,
        title: '國王排名',
        category: '奇幻',
        img: 'img/anime/img8.jpg',
        btn: 'btn8',
        src: 'https://www.youtube.com/embed/P_dPJBjqguo',
        content: '',
    },
    {
        id: 9,
        title: '進擊的巨人',
        category: '驚悚',
        img: 'img/anime/img9.jpg',
        btn: 'btn9',
        src: 'https://www.youtube.com/embed/_WwIAUXZa7k',
        content: '',
    },
    {
        id: 10,
        title: '86不存在的戰區',
        category: '社會寫實',
        img: 'img/anime/img10.jpg',
        btn: 'btn10',
        src: 'https://www.youtube.com/embed/DxgEqj9oTWY',
        content: '',
    },
    {
        id: 11,
        title: '無職轉生',
        category: '冒險',
        img: 'img/anime/img11.jpg',
        btn: 'btn11',
        src: 'https://www.youtube.com/embed/IrT9ZnXW3-Y',
        content: '',
    },
    {
        id: 12,
        title: '咒術迴戰',
        category: '熱血',
        img: 'img/anime/img12.jpg',
        btn: 'btn12',
        src: 'https://www.youtube.com/embed/QH--l_kJ2lE',
        content: '',
    },
    {
        id: 13,
        title: 'Lycoris Recoil 莉可麗絲',
        category: '愛情',
        img: 'img/anime/img13.jpg',
        btn: 'btn13',
        src: 'https://www.youtube.com/embed/uHwCrkoYh3w',
        content: '',
    },
    {
        id: 14,
        title: '相合之物',
        category: '幽默搞笑',
        img: 'img/anime/img14.jpg',
        btn: 'btn14',
        src: 'https://www.youtube.com/embed/5876SRv2rWM',
        content: '',
    },
    {
        id: 15,
        title: '魔法科高中的劣等生追憶篇',
        category: '奇幻',
        img: 'img/anime/img15.jpg',
        btn: 'btn15',
        src: 'https://www.youtube.com/embed/_C_jznWcHuA',
        content: '',
    },
    {
        id: 16,
        title: '鬼滅之刃遊郭篇',
        category: '熱血',
        img: 'img/anime/img16.jpg',
        btn: 'btn16',
        src: 'https://www.youtube.com/embed/rkgXMpU9Jgc',
        content: '',
    },
    {
        id: 17,
        title: '宿命迴響',
        category: '奇幻',
        img: 'img/anime/img17.jpg',
        btn: 'btn17',
        src: 'https://www.youtube.com/embed/VuQPngzh5f8',
        content: '',
    },
];
function ToggleMenu() {
    var menu = document.getElementById('menu');
    if (menu.style.display == '' || menu.style.display == 'block') {
        menu.style.display = 'none';
    } else menu.style.display = 'block';
}
//  輪播圖片
let index = 0;
let ImageCount = document.querySelectorAll('.carousel .container1 img').length;
const bottom = document.querySelector('.carousel .bottom');
for (let i = 0; i < ImageCount; i++) {
    const indicator = document.createElement('div');
    indicator.classList.add('indicator');
    indicator.id = 'num' + i;
    indicator.onclick = () => SetIndex(i);
    bottom.append(indicator);
}
// 自動輪播
function creatAuto() {
    return setInterval(() => {
        index++;
        refresh();
    }, 5000);
}
function refresh() {
    let orange = document.querySelectorAll('.indicator');
    if (index < 0) {
        index = ImageCount - 1;
    } else if (index >= ImageCount) {
        index = 0;
    }
    let ini = 'num' + index;
    let carousel = document.querySelector('.carousel');
    let width = getComputedStyle(carousel).width;
    width = Number(width.slice(0, -2));
    carousel.querySelector('.container1').style.left = index * width * -1 + 'px';
    for (let k = 0; k < ImageCount; k++) {
        orange[k].style.opacity = 0.3;
    }
    document.getElementById(ini).style.opacity = 1;
}
function LeftShift() {
    index--;
    refresh();
}
function RightShift() {
    index++;
    refresh();
}
function SetIndex(idx) {
    index = idx;
    refresh();
}
let autoTimer = creatAuto();
let refreshWrapper = func => {
    return function (...args) {
        let result = func(...args);
        autoTimer;
        refresh();
    };
};
refresh();
// 顯示天數
let date = new Date();
let weekarray = ['Mon', 'Tue', 'Wed', 'Thr', 'Fri', 'Sat', 'Sun'];
function Days() {
    let week;
    if (date.getDay() == 1) {
        week = weekarray[0];
    } else {
        week = weekarray[date.getDay() - 1];
    }
    let day = document.querySelector('.' + week);
    day.style.backgroundColor = '#7bdff2';
    day.style.color = 'white';
}
Days();
// 分類toggle
$(document).ready(function () {
    $('.gateclick').click(function () {
        $('.img_nav_content_outside').slideToggle('slow');
    });
});
// 時程表
function ScheduleVideo() {
    let targetname = event.target.textContent;
    const searchCategory = menu.filter(function (menuItems) {
        if (menuItems.title == targetname) {
            return menuItems;
        }
    });
    var myWindow = window.open('', 'MsgWindow', 'width=1200,height=800');
    myWindow.document.write(
        `<iframe width="1150" height="700" src="${searchCategory[0].src}?autoplay=1&mute=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`
    );
}
//圖片瀏覽
const container = document.querySelector('.btn-container');
const sectionCenter = document.querySelector('.section-center');
function displayMenuItems(menuItems) {
    let displayMenu = menuItems.map(function (item) {
        return `
        <article class="menu-item col">
        <div class="img-heart"><img src="${item.img}" class="photo${item.id}" alt=${item.title} onclick = "Lightbox(${item.id})"">
        <i class="fa-solid fa-heart btncolor ${item.btn}" onclick="loveclick(${item.id})"></i></div>
              <div class="item-info">
                <header>
                  <h1>${item.title}</h1>
                </header>
              </div>
            </article>`;
    });
    displayMenu = displayMenu.join('');
    sectionCenter.innerHTML = displayMenu;
}
window.addEventListener('DOMContentLoaded', function () {
    displayMenuItems(menu);
});
// 按鈕
function displayMenuButtons() {
    const categores = menu.reduce(
        function (values, item) {
            if (!values.includes(item.category)) {
                values.push(item.category);
            }
            return values;
        },
        ['全部']
    );
    const categoryBtns = categores
        .map(function (category) {
            return `<li>
<input type="button" class="filter-btn" value="${category}" name="按鈕名稱" data-id="${category}" style="width:150px;height:50px;"></li>`;
        })
        .join('');
    container.innerHTML = categoryBtns;
    const filterBtns = container.querySelectorAll('.filter-btn');
    filterBtns.forEach(function (btn) {
        //選擇每個按鈕
        // click事件
        btn.addEventListener('click', function (e) {
            //新增點擊事件
            const category = e.currentTarget.dataset.id;
            const menuCategory = menu.filter(function (menuItems) {
                if (menuItems.category === category) {
                    //判斷是否為被選取的類別
                    return menuItems; //回傳所需物件至menuCategory陣列中
                }
            });
            if (category === '全部') {
                displayMenuItems(menu);
                Lightbox();
                lovecolor();
            } else {
                displayMenuItems(menuCategory);
                Lightbox();
                lovecolor();
            }
        });
    });
}
// 搜尋功能
function clicked() {
    let search = document.querySelector('#search').value;
    const searchCategory = menu.filter(function (menuItems) {
        if (menuItems.title.includes(search)) {
            //判斷是否為被選取的類別
            return menuItems; //回傳所需物件至menuCategory陣列中
        }
    });
    displayMenuItems(searchCategory);
    Lightbox();
    lovecolor();
}
window.addEventListener('DOMContentLoaded', function () {
    displayMenuItems(menu); //預設顯示所有內容
    displayMenuButtons(); //顯示按鈕與開啟其功能
});
// 燈箱
function Lightbox(number) {
    let picture = 'photo' + number;
    var modal = document.getElementById('myModal');
    var modalImg = document.getElementById('img01');
    var pictureno = document.getElementsByClassName(picture);
    const pictureCategory = menu.filter(function (menuItems) {
           if (menuItems.id == number) {
               return menuItems;
           }
       });
       if (pictureCategory[0] !== undefined) {
       var modalImg = document.getElementById('img01');
       let modalContent = pictureCategory[0].content;
       modal.style.display = 'block';
       modalImg.src = pictureCategory[0].img;
       document.querySelector('#caption').innerHTML = modalContent;
       // Get the <span> element that closes the modal
       var span = document.getElementsByClassName('close')[0];
       // When the user clicks on <span> (x), close the modal
       span.onclick = function () {
           modal.style.display = 'none';
       };
      }
      showLow();
}
 var text;
 function showLow() {
     text = document.getElementById('caption').innerHTML;
     document.getElementById('caption').innerHTML =`<div id="subText"></div><a id="btn" onclick="change()"></a>`;
     document.getElementById('subText').style.float = 'left';
     document.getElementById('btn').style.float = 'left';
     if (text.length > 9) {
         document.getElementById('subText').innerHTML = text.substring(0, 9);
         document.getElementById('btn').innerHTML = '...顯示全部';
     } else {
         document.getElementById('subText').innerHTML = text;
         document.getElementById('btn').innerHTML = '';
     }
 }
 function change() {
     var t = document.getElementById('btn');
     var tt = document.getElementById('subText');
     if (t.innerHTML == '...顯示全部') {
         tt.innerHTML = text;
         t.innerHTML = '收起';
     } else {
         tt.innerHTML = text.substring(0, 9);
         t.innerHTML = '...顯示全部';
     }
 }
// 我的最愛
function loveclick(btnlight) {
    let btn = 'btn' + btnlight;
    let btnstyle = document.querySelector('.' + btn);
    if (btnstyle.style.color == 'white' || btnstyle.style.color == '') {
        btnstyle.style.color = 'red';
        localStorage.setItem('btn' + btnlight, 'btn' + btnlight);
    } else {
        btnstyle.style.color = 'white';
        localStorage.removeItem('btn' + btnlight);
    }
}
function lovecolor() {
    for (let i = 0; i < menu.length; i++) {
        let btn = 'btn' + i;
        let dom = document.querySelector('.' + btn);
        if (localStorage.getItem(btn) !== null && dom !== null) {
            document.querySelector('.' + btn).style.color = 'red';
        }
    }
}

// 登入
function Showname() {
    if (localStorage.getItem('root') !== null) {
        document.querySelector('.rename').textContent = localStorage.getItem('root') + '/Logout';
         document.querySelector('.renamephone').textContent = localStorage.getItem('root') + '/Logout';
    } else {
        document.querySelector('.rename').textContent = 'Login';
         document.querySelector('.renamephone').textContent = 'Login';
    }
}
function Login() {
    if (localStorage.getItem('root') !== null) {
        localStorage.clear();
        document.querySelector('.rename').textContent = 'Login';
    } else {
        window.location.href = 'storge.html';
    }
}

window.addEventListener('DOMContentLoaded', function () {
    Lightbox();
    ToggleMenu();
    Showname();
    lovecolor();
});
